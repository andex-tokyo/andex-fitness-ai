# ジム記録 × AIメニュー提案 アプリ 仕様書

---

## 1. 概要

本アプリは、ジムでのトレーニングを**簡単に記録**し、その履歴をもとにAI（ChatGPT API等）が**次回メニューを自動提案**するWebアプリである。
スマートフォン片手で扱いやすい**SPファースト設計**と、**マルチユーザー対応（Firebase）**を前提とする。

---

## 2. 想定ユーザー

- 個人で筋トレ、ダイエット、筋肥大、筋力向上を目指す人
- 「次回何をやればいいか」をAIに考えてもらい、**保存は最小タップで済ませたい**人
- データをシンプルに残しつつ、成長を振り返りたい人

---

## 3. コアフロー

1. **初回**：オンボーディングで目標・時間・よく使う種目を設定
2. **セッション開始**：今日の所要時間（20/30/45/60分）と意図（時短/重量/ボリューム/フォーム）を選択
3. **AIメニュー生成（Plan）**：履歴や設定をもとにAIが提案
4. **編集・実行（Actual）**：Planを基に重量・回数・セット・RPEを調整して保存
5. **履歴で振り返り**：進捗や傾向を確認

---

## 4. 初回利用時の仕様

- **オンボーディング**
  - 目標（減量/筋肥大/筋力）、週頻度、想定時間
  - 最近扱った重量や自体重（任意）
  - よく使う種目（3〜6個、推奨リストから選択）

- **初回AIプラン生成（履歴ゼロ時）**
  - 種目はバランス重視（プッシュ/プル/スクワット/体幹）
  - 重量は軽め（申告あれば−10〜20%、なければ自重換算か固定値）
  - 回数・セットは目標別（減量＝高回数、筋力＝低回数など）
  - RPE目標は **6〜7（フォーム優先）**
  - Notesに「軽いウォームアップ」「痛みがあれば中止」など安全策を提示

---

## 5. 機能仕様

### 5.1 認証 / プロファイル

- Supabase Auth
- プロファイル設定に以下を保持：
  - 単位（kg/lb）、目標（減量/肥大/筋力）、デフォルト時間、RPE入力方式、RPEチップ

### 5.2 種目マスター

- 種目の登録・検索・最近使った順表示
- カテゴリ（胸/脚/背など）、器具（バーベル/ダンベル/マシン）を任意保持

### 5.3 セッション（Plan/Actual）

- **Plan**：AIが提案した次回メニュー
- **Actual**：ユーザーが実際に行った結果
- 差分（乖離）を記録し、次回AIに渡す

### 5.4 RPE入力

- スライダーで **1〜10** を選択
- 数値ごとに**短い説明＋色帯＋RIR目安**を表示
  - 例：RPE8「かなりきつい（あと2回）」

- クイックチップ（3/5/7/8/9）で即選択可
- 入力方式は「各セットごと」か「最終セットのみ」を選べる

### 5.5 履歴/可視化

- セッション一覧（時系列）
- 種目ごとの最大重量推移グラフ
- 週ごとの合計トレーニング時間表示

### 5.6 設定

- 単位（kg / lb）切替
- 目標（減量 / 筋肥大 / 筋力）
- デフォルト時間の設定
- RPE入力方式（各セット / 最終セット）
- RPEクイックチップの編集

---

## 6. AI連携仕様

### 入力

- ユーザーの設定（目標、単位、時間、意図）
- 直近Actual（種目・重量・回数・セット・RPE）
- PlanとActualの差分要約（重量やRPEの乖離）
- 回復ルール（同部位は48〜72h空ける）

### 出力

- 種目（3〜5種目、30分想定時）
- 重量・回数・セット・休憩時間
- **target_rpe**（例：7–8を狙う）
- 短いコメント（例：「前回は高負荷だったので今回は維持」）

### フォールバック

- AI失敗時は「標準テンプレPlan」を生成（種目3–4、低〜中強度）

---

## 7. UI仕様（SPファースト）

### 7.1 ナビゲーション

- 下部タブ：🏠ホーム / 🏋️セッション / 📈履歴 / 🧩種目 / ⚙️設定
- 右下FAB：「セッション開始」

### 7.2 ホーム

- 連続記録日数
- 最近のベスト更新バナー
- 「セッション開始」ボタン

### 7.3 セッション開始

- 時間チップ（20/30/45/60分＋カスタム）
- 意図チップ（時短/重量/ボリューム/フォーム）
- 「AIメニューを作成」ボタン

### 7.4 セッション編集

- Planがプリセットされた種目カード
- ±ボタン/スライダーで重量・回数・セット編集
- RPE入力（スライダー＋説明＋クイックチップ）
- クイック保存（Planそのまま / -2.5kg / +1回）

### 7.5 履歴

- セッション一覧
- 種目ごとのベスト推移グラフ
- 週ごとの合計トレーニング時間

### 7.6 設定

- 単位、目標、デフォルト時間、RPE方式、チップ編集

---

## 8. 非機能要件

- **SP最適化**：片手操作、タップ領域44px以上
- **セキュリティ**：Supabase RLSでユーザーごとに完全分離
- **オフライン対応**：最低限キャッシュで直近の履歴表示可能
- **PWA**：ホーム追加、Service Worker対応

---

## 9. MVP開発範囲

- 認証/プロフィール
- 種目マスター
- セッション開始（時間・意図 → AI Plan生成）
- Plan→Actual保存
- RPE 1–10 入力（説明つき）
- 履歴（一覧＋簡易グラフ）
- 設定画面
- SPファーストUI
